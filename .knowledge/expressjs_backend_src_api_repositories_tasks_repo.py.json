{"is_source_file": true, "format": "Python", "description": "This file implements a repository pattern for managing 'Task' objects, supporting both in-memory and MongoDB storage backends. It includes classes for in-memory storage and MongoDB-backed storage, as well as utility functions for serializing tasks and generating timestamps. The file is part of a FastAPI application and references models like TaskCreate, TaskOut, and TaskUpdate.", "external_files": ["src.api.models.tasks"], "external_methods": ["motor.motor_asyncio.AsyncIOMotorDatabase.create_index", "motor.motor_asyncio.AsyncIOMotorDatabase.find", "motor.motor_asyncio.AsyncIOMotorDatabase.find_one", "motor.motor_asyncio.AsyncIOMotorDatabase.insert_one", "motor.motor_asyncio.AsyncIOMotorDatabase.update_one", "motor.motor_asyncio.AsyncIOMotorDatabase.delete_one", "fastapi.HTTPException", "status.HTTP_404_NOT_FOUND"], "published": ["get_tasks_store"], "classes": [{"name": "InMemoryTasksStore", "description": "In-memory implementation of task storage, used as fallback when MongoDB is not configured."}, {"name": "MongoTasksStore", "description": "MongoDB-backed implementation of task storage, managing task data in a MongoDB collection."}], "methods": [{"name": "datetime _now_utc()", "description": "Utility function returning current UTC datetime.", "scope": "", "scopeKind": ""}, {"name": "TaskOut _serialize_task(doc: Dict[str, Any])", "description": "Converts a database document to a TaskOut data model.", "scope": "", "scopeKind": ""}, {"name": "InMemoryTasksStore.list", "description": "Lists tasks from in-memory store with pagination."}, {"name": "InMemoryTasksStore.create", "description": "Creates a new task in in-memory store."}, {"name": "InMemoryTasksStore.get", "description": "Retrieves a task by ID from in-memory store."}, {"name": "InMemoryTasksStore.update", "description": "Updates an existing task in in-memory store."}, {"name": "InMemoryTasksStore.delete", "description": "Deletes a task by ID from in-memory store."}, {"name": "MongoTasksStore.ensure_indexes", "description": "Creates indexes in MongoDB for optimized queries."}, {"name": "MongoTasksStore.list", "description": "Lists tasks from MongoDB with pagination."}, {"name": "MongoTasksStore.create", "description": "Creates a new task in MongoDB collection."}, {"name": "MongoTasksStore.get", "description": "Retrieves a task by ID from MongoDB collection."}, {"name": "MongoTasksStore.update", "description": "Updates a task in MongoDB by ID."}, {"name": "MongoTasksStore.delete", "description": "Deletes a task from MongoDB by ID."}, {"name": "None __init__(self)", "scope": "InMemoryTasksStore", "scopeKind": "class", "description": "unavailable"}, {"name": "None __init__(self, db: AsyncIOMotorDatabase)", "scope": "MongoTasksStore", "scopeKind": "class", "description": "unavailable"}, {"name": "TaskOut create(self, payload: TaskCreate)", "scope": "MongoTasksStore", "scopeKind": "class", "description": "unavailable"}, {"name": "None delete(self, task_id: str)", "scope": "MongoTasksStore", "scopeKind": "class", "description": "unavailable"}, {"name": "None ensure_indexes(self)", "scope": "MongoTasksStore", "scopeKind": "class", "description": "unavailable"}, {"name": "TaskOut get(self, task_id: str)", "scope": "MongoTasksStore", "scopeKind": "class", "description": "unavailable"}, {"name": "InMemoryTasksStore|MongoTasksStore get_tasks_store(db: Optional[AsyncIOMotorDatabase])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[TaskOut] list(self, limit: int, offset: int)", "scope": "MongoTasksStore", "scopeKind": "class", "description": "unavailable"}, {"name": "TaskOut update(self, task_id: str, payload: TaskUpdate)", "scope": "MongoTasksStore", "scopeKind": "class", "description": "unavailable"}], "calls": ["datetime.now", "uuid.uuid4", "self._col.create_index", "self._col.find", "self._col.find_one", "self._col.insert_one", "self._col.update_one", "self._col.delete_one"], "search-terms": ["tasks_repo", "MongoDB", "InMemoryTasksStore", "task serialization", "Mongo collection 'tasks'", "FastAPI HTTPException", "task store factory"], "state": 2, "file_id": 7, "knowledge_revision": 17, "git_revision": "24b8529fe183a1eac35239794bd6a7e6df0af895", "ctags": [{"_type": "tag", "name": "InMemoryTasksStore", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^class InMemoryTasksStore:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "MongoTasksStore", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^class MongoTasksStore:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "InMemoryTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    def __init__(self, db: AsyncIOMotorDatabase) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, db: AsyncIOMotorDatabase)", "scope": "MongoTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "_in_memory_store", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^_in_memory_store = InMemoryTasksStore()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_now_utc", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^def _now_utc() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_serialize_task", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^def _serialize_task(doc: Dict[str, Any]) -> TaskOut:$/", "language": "Python", "typeref": "typename:TaskOut", "kind": "function", "signature": "(doc: Dict[str, Any])"}, {"_type": "tag", "name": "create", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def create(self, payload: TaskCreate) -> TaskOut:$/", "language": "Python", "typeref": "typename:TaskOut", "kind": "member", "signature": "(self, payload: TaskCreate)", "scope": "InMemoryTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "create", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def create(self, payload: TaskCreate) -> TaskOut:$/", "language": "Python", "typeref": "typename:TaskOut", "kind": "member", "signature": "(self, payload: TaskCreate)", "scope": "MongoTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "delete", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def delete(self, task_id: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, task_id: str)", "scope": "InMemoryTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "delete", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def delete(self, task_id: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, task_id: str)", "scope": "MongoTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "ensure_indexes", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def ensure_indexes(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MongoTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def get(self, task_id: str) -> TaskOut:$/", "language": "Python", "typeref": "typename:TaskOut", "kind": "member", "signature": "(self, task_id: str)", "scope": "InMemoryTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def get(self, task_id: str) -> TaskOut:$/", "language": "Python", "typeref": "typename:TaskOut", "kind": "member", "signature": "(self, task_id: str)", "scope": "MongoTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "get_tasks_store", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^def get_tasks_store(db: Optional[AsyncIOMotorDatabase]) -> InMemoryTasksStore | MongoTasksStore:$/", "language": "Python", "typeref": "typename:InMemoryTasksStore|MongoTasksStore", "kind": "function", "signature": "(db: Optional[AsyncIOMotorDatabase])"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def list(self, limit: int, offset: int) -> List[TaskOut]:$/", "language": "Python", "typeref": "typename:List[TaskOut]", "kind": "member", "signature": "(self, limit: int, offset: int)", "scope": "InMemoryTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def list(self, limit: int, offset: int) -> List[TaskOut]:$/", "language": "Python", "typeref": "typename:List[TaskOut]", "kind": "member", "signature": "(self, limit: int, offset: int)", "scope": "MongoTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "update", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def update(self, task_id: str, payload: TaskUpdate) -> TaskOut:$/", "language": "Python", "typeref": "typename:TaskOut", "kind": "member", "signature": "(self, task_id: str, payload: TaskUpdate)", "scope": "InMemoryTasksStore", "scopeKind": "class"}, {"_type": "tag", "name": "update", "path": "/home/kavia/workspace/code-generation/fullstack-application-scaffold-7150-7159/expressjs_backend/src/api/repositories/tasks_repo.py", "pattern": "/^    async def update(self, task_id: str, payload: TaskUpdate) -> TaskOut:$/", "language": "Python", "typeref": "typename:TaskOut", "kind": "member", "signature": "(self, task_id: str, payload: TaskUpdate)", "scope": "MongoTasksStore", "scopeKind": "class"}], "hash": "cceb2aed6a0320655eec1ecf61c7496d", "format-version": 4, "code-base-name": "expressjs_backend", "filename": "expressjs_backend/src/api/repositories/tasks_repo.py", "fields": [{"name": "_in_memory_store = InMemoryTasksStore()", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"17": "24b8529fe183a1eac35239794bd6a7e6df0af895"}]}